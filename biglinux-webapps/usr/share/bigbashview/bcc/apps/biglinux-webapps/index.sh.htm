#!/usr/bin/env bash

#Suporte a tradução no bash
export TEXTDOMAINDIR="/usr/share/locale"
export TEXTDOMAIN=biglinux-webapps

#Criando diretórios necessários
mkdir -p $HOME/.local/share/icons
mkdir -p $HOME/.local/share/applications
mkdir -p $HOME/.local/bin/
mkdir -p $HOME/.local/share/desktop-directories
mkdir -p $HOME/.config/menus/applications-merged

#Verificando se os arquivos .directory existem
if [ ! -e $HOME/.local/share/desktop-directories/google-apps.directory -o \
     ! -e $HOME/.local/share/desktop-directories/web-apps.directory ];then
    cp /usr/share/biglinux/webapps/share/*.directory $HOME/.local/share/desktop-directories
fi

#Verificando se os arquivos .menu existem
if [ ! -e $HOME/.config/menus/applications-merged/google-applications.menu -o \
     ! -e $HOME/.config/menus/applications-merged/user-web-apps.menu ];then
    cp /usr/share/biglinux/webapps/share/*.menu $HOME/.config/menus/applications-merged
fi

#Capturando a hora do sistema
hour="$(date +%H)"

#Mensagem personalizada conforme a hora da abertura do app
if [ "$hour" -ge "06" -a "$hour" -le "12" ];then
    msg=$"Bom dia ""$USER!"
elif [ "$hour" -ge "12" -a "$hour" -le "19" ];then
    msg=$"Boa tarde ""$USER!"
else
    msg=$"Boa noite ""$USER!"
fi

#Início da página HTML
echo "
    <!-- Cabeçalho -->
    <head>

        <!-- Carregando o tema css do app -->
        <link rel='stylesheet' type='text/css' href='css/bootstrap.min.css'>

        <!-- Carregando jquery e o js necessário -->
        <script src='js/jquery-3.6.0.min.js'></script>
        <script src='js/bootstrap.bundle.min.js'></script>

        <!--Alguns ajustes no tema -->
        <style>
          .btn{
              width: 200px;
          }
          body{
              background-image: url('img/background.jpg');
              background-repeat: no-repeat;

          }
        </style>

    </head>

    <!-- Corpo da página -->
    <body oncontextmenu='return false;'>
        <div class='container'><hr>"

        echo '<p class="text-center h3" style="font-weight:bold">
                '"$msg"'<br>
                '$"Bem-Vindo(a) ao Gerenciador de WebApps BigLinux" '
             </p><hr>'

        echo '<div class="row justify-content-center">
                <div class="col-3">
                    <a href="index-install.sh.htm"
                       class="css_btn_class black-text tooltipped"
                       data-position="top" data-delay="100"
                       data-tooltip="'$"Instala um novo WebApp BigLinux"'">
                       <button class="btn btn-lg btn-outline-dark">
                           <img src="img/add.png"/><br>' $"Instalar WebApps"'
                       </button>
                    </a>
                </div>
                <div class="col-1"></div>
                <div class="col-3">
                    <a href="index-edit.sh.htm"
                       class="css_btn_class black-text tooltipped"
                       data-position="top" data-delay="100"
                       data-tooltip="'$"Edita um WebApp BigLinux"'">
                       <button class="btn btn-lg btn-outline-primary">
                           <img src="img/edit.png"/><br>' $"Editar WebApps"'
                       </button>
                    </a>
                </div>
              </div><hr>
              <div class="row justify-content-center">
                <div class="col-3">
                    <a href="index-remove.sh.htm"
                       class="css_btn_class black-text tooltipped"
                       data-position="top" data-delay="100"
                       data-tooltip="'$"Remove um WebApp BigLinux"'">
                       <button class="btn btn-lg btn-outline-info">
                           <img src="img/delete.png"/><br>' $"Remover WebApps"'
                       </button>
                    </a>
                </div>
                <div class="col-1"></div>
                <div class="col-3">
                    <a href="index2.sh.htm"
                       class="css_btn_class black-text tooltipped"
                       data-position="top" data-delay="100"
                       data-tooltip="'$"Ative ou desative os WebApps instalados por padrão no sistema"'">
                       <button class="btn btn-lg btn-outline-info">
                          <img src="img/toggle.png"/><br>' $"Ativar/Desativar WebApps" '
                       </button>
                    </a>
                </div>
            </div>
        </div>
    </body>'
