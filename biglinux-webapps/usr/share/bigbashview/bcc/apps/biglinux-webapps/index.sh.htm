#!/usr/bin/env bash

# Suporte a tradução no bash
export TEXTDOMAINDIR="/usr/share/locale"
export TEXTDOMAIN=biglinux-webapps

# Criando diretórios necessários
mkdir -p $HOME/.local/share/icons
mkdir -p $HOME/.local/share/applications
mkdir -p $HOME/.local/bin/
mkdir -p $HOME/.local/share/desktop-directories
mkdir -p $HOME/.config/menus/applications-merged

# Verificando se os arquivos .directory existem
if [ ! -e $HOME/.local/share/desktop-directories/google-apps.directory -o \
     ! -e $HOME/.local/share/desktop-directories/web-apps.directory ];then
    cp /usr/share/biglinux/webapps/share/*.directory $HOME/.local/share/desktop-directories
fi

# Verificando se os arquivos .menu existem
if [ ! -e $HOME/.config/menus/applications-merged/google-applications.menu -o \
     ! -e $HOME/.config/menus/applications-merged/user-web-apps.menu ];then
    cp /usr/share/biglinux/webapps/share/*.menu $HOME/.config/menus/applications-merged
fi

# Capturando a hora do sistema
hour="$(date +%H)"

# Mensagem personalizada conforme a hora do sistema
if [ "$hour" -ge "06" -a "$hour" -le "12" ];then
    msg=$"Bom dia ""$USER!"
elif [ "$hour" -ge "12" -a "$hour" -le "18" ];then
    msg=$"Boa tarde ""$USER!"
else
    msg=$"Boa noite ""$USER!"
fi

# Início da página HTML
echo "
<!-- Cabeçalho -->
<head>

    <!-- Carregando o tema css do app -->
    <link rel='stylesheet' type='text/css' href='css/bootstrap.min_litera.css'>
    <link rel='stylesheet' type='text/css' href='css/tooltip.css'>

    <!-- Carregando jquery e o js necessário -->
    <script src='js/jquery-3.6.0.min.js'></script>
    <script src='js/bootstrap.bundle.min.js'></script>

</head>

<!-- Corpo da página -->
<body oncontextmenu='return false;' id='init'>
    <div class='container-fluid'>"

    echo '<p class="text-center h3">
            '"$msg"'<br>
            '$"Bem-Vindo(a) ao Gerenciador de WebApps BigLinux" '
         </p><hr><br>'

    echo '<div class="row justify-content-center">
            <div class="col-3">
                <a href="index-install.sh.htm"
                   class="btn btn-lg btn-init btn-primary align-content-center border-dark"
                   tooltip="'$"Instala um novo WebApp BigLinux"'">
                       <img src="img/add.png"/><br>' $"Instalar<br>WebApps"'
                </a>
            </div>

            <div class="col-3">
                <a href="index-edit.sh.htm"
                   class="btn btn-lg btn-init btn-primary align-content-center border-dark"
                   tooltip="'$"Edita um WebApp BigLinux"'">
                       <img src="img/edit.png"/><br>' $"Editar<br>WebApps"'
                </a>
            </div>
          </div><br/>
          <div class="row justify-content-center">
            <div class="col-3">
                <a href="index-remove.sh.htm"
                   class="btn btn-lg btn-init btn-primary align-content-center border-dark"
                   tooltip="'$"Remove um WebApp BigLinux"'">
                       <img src="img/delete.png"/><br>' $"Remover<br>WebApps"'
                </a>
            </div>

            <div class="col-3">
                <a href="index2.sh.htm"
                   class="btn btn-lg btn-init btn-primary align-content-center border-dark"
                   tooltip="'$"Ative ou desative os WebApps instalados por padrão no sistema"'">
                      <img src="img/toggle.png"/><br>' $"Ativar/Desativar WebApps" '
                </a>
            </div>
        </div>
    </div>
</body>'
