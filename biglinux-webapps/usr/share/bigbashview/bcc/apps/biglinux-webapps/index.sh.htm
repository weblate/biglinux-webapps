#!/usr/bin/env bash

# Suporte a tradução no bash
export TEXTDOMAINDIR="/usr/share/locale"
export TEXTDOMAIN=biglinux-webapps

# Criando diretórios necessários
mkdir -p $HOME/.local/share/icons
mkdir -p $HOME/.local/share/applications
mkdir -p $HOME/.local/bin/
mkdir -p $HOME/.local/share/desktop-directories
mkdir -p $HOME/.config/menus/applications-merged

# Verificando se os arquivos .directory existem
if [ ! -e $HOME/.local/share/desktop-directories/google-apps.directory -o \
     ! -e $HOME/.local/share/desktop-directories/web-apps.directory ];then
    cp /usr/share/biglinux/webapps/share/*.directory $HOME/.local/share/desktop-directories
fi

# Verificando se os arquivos .menu existem
if [ ! -e $HOME/.config/menus/applications-merged/google-applications.menu -o \
     ! -e $HOME/.config/menus/applications-merged/user-web-apps.menu ];then
    cp /usr/share/biglinux/webapps/share/*.menu $HOME/.config/menus/applications-merged
fi

# Capturando a hora do sistema
hour="$(date +%H)"

# Mensagem personalizada conforme a hora do sistema
if [ "$hour" -ge "06" -a "$hour" -le "12" ];then
    msg=$"Bom dia ""$USER!"
elif [ "$hour" -ge "12" -a "$hour" -le "18" ];then
    msg=$"Boa tarde ""$USER!"
else
    msg=$"Boa noite ""$USER!"
fi

# Início da página HTML
echo '
<!-- Cabeçalho -->
<head>

    <!-- Carregando o tema css do app -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min_litera.css">
    <link rel="stylesheet" type="text/css" href="css/tooltip.css">

    <!-- Carregando jquery e o js necessário -->
    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/app.js"></script>

</head>

<!-- Corpo da página -->
<body id="init">
    <div class="container-fluid">
        <p class="text-center h3">
            '"$msg"'<br>
            '$"Bem-Vindo(a) ao Gerenciador de WebApps BigLinux"'
        </p><hr>
        <div class="row justify-content-center">
            <div class="col-3">
                <a href="index-install.sh.htm"
                   class="btn btn-lg btn-init btn-dark align-content-center border-dark"
                   data-bs-toggle="tooltip" data-bs-placement="top"
                   title="'$"Instala um novo WebApp BigLinux"'">
                       <i class="bi init bi-plus-circle"></i><br>
                       '$"Instalar<br>WebApps"'
                </a>
            </div>

            <div class="col-3">
                <a href="index-edit.sh.htm"
                   class="btn btn-lg btn-init btn-dark align-content-center border-dark"
                   data-bs-toggle="tooltip" data-bs-placement="top"
                   title="'$"Edita um WebApp BigLinux"'">
                       <i class="bi init bi-pencil-square"></i><br>
                       '$"Editar<br>WebApps"'
                </a>
            </div>
        </div><br/>
        <div class="row justify-content-center">
            <div class="col-3">
                <a href="index-remove.sh.htm"
                   class="btn btn-lg btn-init btn-dark align-content-center border-dark"
                   data-bs-toggle="tooltip" data-bs-placement="top"
                   title="'$"Remove um WebApp BigLinux"'">
                       <i class="bi init bi-trash-fill"></i><br>
                       '$"Remover<br>WebApps"'
                </a>
            </div>

            <div class="col-3">
                <a href="index2.sh.htm" id="btn-enable-0"
                   class="btn btn-lg btn-init btn-dark align-content-center border-dark"
                   data-bs-toggle="tooltip" data-bs-placement="top"
                   title="'$"Ative ou desative os WebApps instalados por padrão no sistema"'">
                      <i class="bi init bi-toggles"></i><br>
                      '$"Ativar/Desativar<br>WebApps"'
                    <span class="spinner-border spinner-border-sm"
                          role="status" aria-hidden="true"
                          id="btn-spin"></span>
                </a>
            </div>
        </div>
    </div>
</body>'
