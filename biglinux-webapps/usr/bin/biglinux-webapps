#!/usr/bin/env bash

# Criando diretórios necessários
mkdir -p $HOME/.bigwebapps
mkdir -p $HOME/.local/share/icons
mkdir -p $HOME/.local/share/applications
mkdir -p $HOME/.local/bin

[ ! -e $HOME/.bigwebapps/BROWSER ] && echo 'brave' > $HOME/.bigwebapps/BROWSER

for webapp in /usr/share/bigbashview/bcc/apps/biglinux-webapps/webapps/*.desktop; do
    WEB_APP="$HOME/.local/share/applications/${webapp##*/}"
    [[ -e ${WEB_APP} && ! "$(grep Categories <<< ${app})" ]] && {
        cp -f ${webapp} ${WEB_APP}
    }
done

for app in ~/.local/share/applications/*-webapp-biglinux-custom.desktop;do
    [[ -e ${app} && ! "$(grep Categories <<< ${app})" ]] && {
        echo 'Categories=Webapps;' >> ${app}
    }
done

if [ -d $HOME/.local/share/desktop-directories ];then
    rm -r $HOME/.local/share/desktop-directories
fi

if [ -d $HOME/.config/menus ];then
    rm -r $HOME/.config/menus
fi

if [ "${LANG:0:2}" = "pt" ]
then
    BIGBASHVIEW_LANG="pt"

elif [ "${LANG:0:2}" = "es" ]
then
    BIGBASHVIEW_LANG="es"

else
    BIGBASHVIEW_LANG="en"
fi

cd /usr/share/bigbashview/bcc/apps/biglinux-webapps
LANGUAGE=$BIGBASHVIEW_LANG bigbashview -s 960x600 -n "Gerenciador de WebApps BigLinux" -i icons/webapp.svg index.sh.htm
rm /tmp/*.png 2>/dev/null
